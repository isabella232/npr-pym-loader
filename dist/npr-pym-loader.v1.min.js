/*! npr-pym-loader.js - v1.0.1 - 2017-05-19 */

!function(a,b){var c=function(a){var b=document.createEvent("Event");b.initEvent("npr-pym-loader:"+a,!0,!0),document.dispatchEvent(b)},d=function(a,b){if(a){b||c("pym-loaded");var d=a.autoInit();return window.npr_pym_loading=void 0,d}return b||(window.npr_pym_loading=void 0),null},e=function(a,b,d){if(a&&b){d||c("carebot-loaded");for(var e=a.autoInitInstances,f=0;f<e.length;++f)null==e[f].el.getAttribute("data-carebot-skip")&&function(){var a=e[f];new b.VisibilityTracker(a.id,function(b){0!==a.el.getElementsByTagName("iframe").length&&a.sendMessage("on-screen",b.bucket)}),d||c("carebot-visibility-added"),document.querySelector("[data-carebot-scroll]")||(d||c("carebot-scroll-added"),a.el.setAttribute("data-carebot-scroll",""),new b.ScrollTracker("storytext",function(b,c){0!==a.el.getElementsByTagName("iframe").length&&a.sendMessage("scroll-depth",JSON.stringify({percent:b,seconds:c}))}))}()}},f="https://pym.nprapps.org/pym.v1.min.js",g="https://carebot.nprapps.org/carebot-tracker.v0.min.js";if(g=function(){return!!window.location.href.match(/^https?:\/\/(www(-s1)?\.)?npr\.org/)}()?g:null,!document.querySelectorAll("[data-pym-auto-initialized]").length&&!window.npr_pym_loading){window.npr_pym_loading=!0,function(b,c){if(void 0!==a){b=b.split(".js")[0];var f={pym:b},g={pym:{exports:"pym"}},h=["require","pym"];c&&(c=c.split(".js")[0],f.carebot=c,g.carebot={exports:"carebot"},h.push("carebot"));var i="context_"+b.split("/").slice(-1)[0];return a.config({context:i,paths:f,shim:g})(h,function(a,b,c){d(b),c&&e(b,c)}),!0}return!1}(f,g)||function(a,c){return void 0!==b&&"function"==typeof b.getScript&&(b.getScript(a).done(function(){c&&b.getScript(c).done(function(){e(window.pym,window.CarebotTracker)})}).fail(function(){console.error("could not load pym with jQuery"),window.npr_pym_loading=void 0}),!0)}(f,g)||function(a,b){var c=document.getElementsByTagName("head")[0],f=document.createElement("script");f.type="text/javascript",f.src=a,f.onload=function(){if(c&&f.parentNode&&c.removeChild(f),d(window.pym),b){c=document.getElementsByTagName("head")[0];var a=document.createElement("script");a.type="text/javascript",a.src=b,a.onload=function(){c&&a.parentNode&&c.removeChild(a),e(window.pym,window.CarebotTracker)},c.appendChild(a)}},f.onerror=function(){console.error("could not append pym via embedding"),window.npr_pym_loading=void 0},c.appendChild(f)}(f,g);var h=function(){return document.removeEventListener("DOMContentLoaded",h),window.removeEventListener("load",h),d(window.pym,!0)};window.document.addEventListener("DOMContentLoaded",h),window.addEventListener("load",h)}}(window.requirejs,window.jQuery);